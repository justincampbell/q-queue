#!/usr/bin/env sh

set -euo pipefail
IFS=$'\n\t'

q_help() {
  echo "q-queue v0.1.0"
  echo "github.com/justincampbell/q-queue"
  echo ""
  echo "  Usage:"
  echo "    q [COMMAND]  Queue command to run at a later time in this directory"
  echo ""
}

q_list() {
  cat $qfile
}

q_write() {
  echo "$PWD $qcommand" >> $HOME/.q
}

qcommand="$@"
qfile="$HOME/.q"

if [ -z "$qcommand" ]; then
  if [ -f "$qfile" ] && grep -iq " " $qfile; then
    q_list
  else
    q_help
    exit 1
  fi
else
  q_write
fi
